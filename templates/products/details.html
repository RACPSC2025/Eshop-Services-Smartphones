{% extends 'base.html' %} {% load static %} {% block title %}Detalles del
Servicio | MiXiaomiUnlock{% endblock %} {% block content %}
<div
    class="font-display bg-white dark:bg-background-dark min-h-screen animate-fade-in pb-32"
>
    <!-- Breadcrumb Header -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <a
            href="/catalog"
            class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-800 text-sm font-bold text-gray-600 dark:text-gray-300 hover:bg-accent hover:text-white transition-all group"
        >
            <span
                class="material-icons text-sm group-hover:-translate-x-1 transition-transform"
                >arrow_back</span
            >
            Regresar al Catálogo
        </a>
    </div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="lg:grid lg:grid-cols-12 lg:gap-16">
            <!-- Gallery - Sticky on Desktop -->
            <div class="lg:col-span-7 lg:sticky lg:top-24 lg:h-min z-10">
                <!-- Main Image Container -->
                <div
                    class="w-full bg-[#F5F5F7] dark:bg-gray-900 rounded-[2.5rem] overflow-hidden relative group aspect-[4/3] flex items-center justify-center p-8 mb-6 border border-gray-100 dark:border-gray-800 transition-colors duration-500"
                >
                    {% if product.image %}
                    <img
                        id="main-image"
                        src="{{ product.image.url }}"
                        alt="{{ product.name }}"
                        class="max-h-full max-w-full object-contain animate-fade-in transition-transform duration-500 group-hover:scale-105 shadow-2xl rounded-2xl z-10 mix-blend-multiply dark:mix-blend-normal"
                    />
                    {% else %}
                    <img
                        id="main-image"
                        src="https://via.placeholder.com/800x600/cccccc/666666?text=No+Image"
                        alt="{{ product.name }}"
                        class="max-h-full max-w-full object-contain animate-fade-in transition-transform duration-500 group-hover:scale-105 shadow-2xl rounded-2xl z-10 mix-blend-multiply dark:mix-blend-normal"
                    />
                    {% endif %}
                    <!-- Abstract decorative circle -->
                    <div
                        class="absolute w-64 h-64 bg-accent/5 rounded-full blur-3xl z-0"
                    ></div>
                </div>

                <!-- Thumbnails -->
                <div
                    class="flex gap-4 overflow-x-auto pb-4 hide-scroll justify-center"
                >
                    {% if product.image %}
                    <button
                        class="thumb-btn w-20 h-20 flex-shrink-0 rounded-2xl overflow-hidden border-2 transition-all p-1 bg-gray-50 dark:bg-gray-800 border-accent ring-2 ring-accent/20"
                        data-src="{{ product.image.url }}"
                    >
                        <img
                            src="{{ product.image.url }}"
                            class="w-full h-full object-cover rounded-xl"
                            alt="{{ product.name }}"
                        />
                    </button>
                    {% endif %}
                </div>
            </div>

            <!-- Config & Info Section -->
            <div class="lg:col-span-5 mt-8 lg:mt-0 relative z-20">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        {% if product.category %}
                        <span
                            class="text-accent font-bold uppercase tracking-widest text-xs mb-1 block"
                        >
                            {{ product.category|capfirst }}
                        </span>
                        {% endif %}
                        <h1
                            class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2 leading-tight"
                            id="product-name"
                        >
                            {{ product.name }}
                        </h1>
                        <div
                            class="flex items-center gap-2 text-sm text-gray-500"
                        >
                            {% if product.rating %}
                            <div class="flex text-yellow-400 text-sm">
                                {% for i in "12345" %} {% if i|add:0 <=
                                product.rating|floatformat:0|add:0 %}
                                <span class="material-icons text-sm">star</span>
                                {% elif
                                product.rating|floatformat:0|add:0|stringformat:"s"|slice:":1"
                                == i and
                                product.rating|stringformat:"s"|slice:"-1:" !=
                                ".0" %}
                                <span class="material-icons text-sm"
                                    >star_half</span
                                >
                                {% else %}
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                                {% endif %} {% endfor %}
                            </div>
                            <span
                                >{{ product.rating }} ({{
                                product.name|length|add:100 }} Reviews)</span
                            >
                            {% else %}
                            <div class="flex text-gray-300 text-sm">
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                                <span class="material-icons text-sm"
                                    >star_border</span
                                >
                            </div>
                            <span>No reviews</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="h-px bg-gray-100 dark:border-gray-800 my-6"></div>

                <p
                    class="text-gray-600 dark:text-gray-300 mb-8 leading-relaxed"
                >
                    {{ product.description }}
                </p>

                <!-- Dynamic Options -->
                <div class="mb-8">
                    <h3
                        class="text-sm font-bold text-gray-900 dark:text-white mb-4"
                    >
                        Opciones de Servicio:
                    </h3>
                    <div class="space-y-3" id="options-container">
                        <!-- Default Option -->
                        <div
                            class="service-option cursor-pointer border-2 rounded-2xl p-4 flex justify-between items-center transition-all duration-200 relative overflow-hidden group border-accent bg-accent/5"
                            data-price="{{ product.price }}"
                            data-label="Opción Principal"
                            onclick="selectOption(this)"
                        >
                            <div class="relative z-10 flex gap-4 items-center">
                                <div
                                    class="radio-indicator w-5 h-5 rounded-full border-2 border-accent flex items-center justify-center"
                                >
                                    <div
                                        class="w-2.5 h-2.5 rounded-full bg-accent"
                                    ></div>
                                </div>
                                <div>
                                    <div
                                        class="option-label font-bold text-sm md:text-base text-accent"
                                    >
                                        {{ product.name }}
                                    </div>
                                    <div class="text-xs text-gray-500">
                                        Precio estándar
                                    </div>
                                </div>
                            </div>
                            <div
                                class="font-bold text-gray-900 dark:text-white relative z-10"
                            >
                                ${{ product.price }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Primary CTA Button (Reference for Sticky) -->
                <div class="flex gap-4 mb-10" id="main-cta-container">
                    <button
                        onclick="addToCart()"
                        class="flex-1 bg-gray-900 dark:bg-white text-white dark:text-black py-4 rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl hover:shadow-gray-900/20 transition-all transform hover:-translate-y-1 active:scale-95 flex items-center justify-center gap-2"
                    >
                        <span>Añadir al Carrito</span>
                        <span class="material-icons text-sm"
                            >shopping_cart</span
                        >
                    </button>
                    <button
                        onclick="toggleWishlist(this)"
                        class="w-16 rounded-2xl flex items-center justify-center transition-colors border border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-500 hover:text-red-500 hover:border-red-200"
                    >
                        <span class="material-icons">favorite_border</span>
                    </button>
                </div>

                <!-- Accordion Specs -->
                <div class="space-y-4">
                    <details
                        class="group bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-transparent hover:border-gray-200 dark:hover:border-gray-700 transition-colors"
                        open
                    >
                        <summary
                            class="flex items-center justify-between p-4 cursor-pointer list-none font-bold text-gray-800 dark:text-gray-200"
                        >
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-gray-400"
                                    >verified_user</span
                                >
                                Garantía y Seguridad
                            </div>
                            <span
                                class="material-icons transition-transform group-open:rotate-180"
                                >expand_more</span
                            >
                        </summary>
                        <div
                            class="px-4 pb-4 pl-11 text-sm text-gray-500 leading-relaxed animate-fade-in"
                        >
                            Ofrecemos garantía de satisfacción de 90 días en
                            todos los repuestos originales y soporte post-venta
                            dedicado.
                        </div>
                    </details>

                    <details
                        class="group bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-transparent hover:border-gray-200 dark:hover:border-gray-700 transition-colors"
                    >
                        <summary
                            class="flex items-center justify-between p-4 cursor-pointer list-none font-bold text-gray-800 dark:text-gray-200"
                        >
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-gray-400"
                                    >schedule</span
                                >
                                Tiempo Estimado
                            </div>
                            <span
                                class="material-icons transition-transform group-open:rotate-180"
                                >expand_more</span
                            >
                        </summary>
                        <div
                            class="px-4 pb-4 pl-11 text-sm text-gray-500 leading-relaxed animate-fade-in"
                        >
                            El servicio estándar suele procesarse en 24 horas.
                            Los envíos físicos dependen de la paquetería (2-4
                            días hábiles).
                        </div>
                    </details>
                </div>
            </div>
        </div>
    </main>

    <!-- UX KILLER FEATURE: Sticky Action Bar -->
    <div
        id="sticky-bar"
        class="fixed bottom-0 left-0 right-0 bg-white dark:bg-card-dark border-t border-gray-200 dark:border-gray-800 p-4 shadow-[0_-10px_30px_rgba(0,0,0,0.1)] transition-transform duration-300 z-50 translate-y-full"
    >
        <div class="max-w-7xl mx-auto flex items-center justify-between gap-4">
            <div class="hidden md:block">
                <div
                    class="text-sm font-bold text-gray-900 dark:text-white"
                    id="sticky-title"
                >
                    {{ product.name }}
                </div>
                <div class="text-xs text-gray-500" id="sticky-variant">
                    Opción Principal
                </div>
            </div>

            <div
                class="flex items-center gap-4 flex-1 md:flex-none justify-end"
            >
                <div class="flex flex-col items-end md:items-start">
                    <span
                        class="font-bold text-xl text-primary dark:text-white"
                        id="sticky-price"
                        >${{ product.price }}</span
                    >
                    <span
                        class="text-[10px] text-green-500 font-bold hidden md:block"
                        >En Stock</span
                    >
                </div>
                <button
                    onclick="addToCart()"
                    class="bg-accent hover:bg-accent-hover text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-accent/20 transition-transform active:scale-95 flex items-center gap-2"
                >
                    <span class="hidden md:inline">Añadir Ahora</span>
                    <span class="md:hidden">Añadir</span>
                    <span class="material-icons text-sm">shopping_cart</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Success Toast (Reused from Cart/Contact logic logic, simplified) -->
<div
    id="cart-toast"
    class="fixed top-24 right-6 z-[100] transition-all duration-500 transform translate-x-10 opacity-0 pointer-events-none"
>
    <div
        class="bg-white dark:bg-card-dark border-l-4 border-accent text-primary dark:text-white pl-4 pr-6 py-4 rounded-r-xl shadow-2xl flex items-center gap-4 min-w-[300px]"
    >
        <div class="bg-accent/10 rounded-full p-2 text-accent">
            <span class="material-icons text-xl">shopping_cart</span>
        </div>
        <div>
            <h4 class="font-bold text-sm">Agregado al Carrito</h4>
            <span
                class="text-sm text-gray-500 dark:text-gray-400 font-medium"
                id="toast-product-name"
                >{{ product.name }}</span
            >
        </div>
    </div>
</div>

{% endblock %}
<script src="{% static 'js/details.js' %}" defer></script>
